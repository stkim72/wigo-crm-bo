<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ceragem.crm.camp.dao.CrmCampBasDao">
    <sql id="sqlPkConditions">
                WHERE CAMP_BAS_NO       =       #{campBasNo}
    </sql>
    <sql id="sqlCols">
                      CAMP_BAS_NO                    /*캠페인기본번호        */
                    , CAMP_TYPE_CD                    /*캠페인유형코드        */
                    , QSTNR_BAS_NO                    /*설문기본번호        */
                    , CAMP_SHAP_CD                    /*캠페인형태코드        */
                    , CAMP_EXEC_CNT                    /*캠페인실행수        */
                    , CAMP_COND_CD                    /*캠페인조건코드        */
                    , PRNTS_CAMP_BAS_NO                    /*부모캠페인기본번호        */
                    , FROM_APPLY_SALE_AMT                    /*FROM적용매출금액        */
                    , TO_APPLY_SALE_AMT                    /*TO적용매출금액        */
                    , FROM_APPLY_SALE_COND_CD                    /*FROM적용매출조건코드        */
                    , TO_APPLY_SALE_COND_CD                    /*TO적용매출조건코드        */
                    , FROM_APPLY_SNCT_AMT                    /*FROM적용결재금액        */
                    , TO_APPLY_SNCT_AMT                    /*TO적용결재금액        */
                    , FROM_APPLY_PAY_COND_CD                    /*FROM적용결제조건코드        */
                    , TO_APPLY_PAY_COND_CD                    /*TO적용결제조건코드        */
                    , APPLY_MSHIP_GRADE_CD                    /*적용멤버십등급코드        */
                    , CAMP_STA_YMD                    /*캠페인시작년월일        */
                    , CAMP_END_YMD                    /*캠페인종료년월일        */
                    , RPEAT_YN                    /*반복여부        */
                    , RPEAT_CD                    /*반복코드        */
                    , RPEAT_MONTH                    /*반복월        */
                    , RPEAT_DAY                    /*반복일        */
                    , RPEAT_DOW_PLCY_CD                    /*반복요일정책코드        */
                    , CAMP_STATUS_CD                    /*캠페인상태코드        */
                    , WHOLE_BDGET_AMT                    /*전체예산금액        */
                    , CAMP_FTGABLT_PLCY_CD                    /*캠페인피로도정책코드        */
                    , CAMP_BAS_NM                    /*캠페인기본명        */
                    , CAMP_BAS_CTNTS                    /*캠페인기본내용        */
                    , AMDR_ID                    /*수정자ID        */
                    , AMD_DT                    /*수정일시        */
                    , REGR_ID                    /*등록자ID        */
                    , REG_DT                    /*등록일시        */
                    , REG_CHL_CD                    /*등록채널코드        공통코드 : S000        [CRM : CRM , CTC : 상담 , AS : AS , SAP : SAP , POS : POS , BOS : BOS , MEM : 멤버십 , CERA : 세라체크 , DNA : 세라DNA , IoT : IoT]*/
                    , ORDR_CHL_LIST                    /*주문채널리스트        */
                    , DSP_HOUR                    /*발송시간        */
                    , DOW_1_USE_YN                    /*월요일사용여부        */
                    , DOW_2_USE_YN                    /*화요일사용여부        */
                    , DOW_3_USE_YN                    /*수요일사용여부        */
                    , DOW_4_USE_YN                    /*목요일사용여부        */
                    , DOW_5_USE_YN                    /*금요일사용여부        */
                    , DOW_6_USE_YN                    /*토요일사용여부        */
                    , DOW_7_USE_YN                    /*일요일사용여부        */
                    , APPLY_POINT
                    , APPLY_CUST_CNT
                    , APPLY_COUPN_BAS_NO
                    , APPLY_GRP_NO
                    , DSP_CHL_CD							
                    , DSP_CTNT_TYPE_NO
                    , APPLY_POINT_STA_YMD                    /*적용포인트유효기간시작년월일        */
                    , APPLY_POINT_END_YMD                    /*적용포인트유효기간종료년월일        */
                    , SALE_OCCUR_STA_YMD                    /*매출발생시작년월일        */
                    , SALE_OCCUR_END_YMD                    /*매출발생종료년월일        */
                    , END_AFTR_DAY_CNT                    /*종료후일수        */
                   
                    , LOW_RSPN_CAMP_NO                    /*하위캠페인기본번호        */
                    , LOW_RSPN_DNA_CAMP_NO                    /*하위반응미적용캠페인번호        */
                    , RSPN_APPLY_YN
                    , DAY_GAP_CNT                    /*일차이수        */
                    , COUPN_ISSUE_CNT			   /* 쿠폰발행수 */
                     , APPLY_POINT_VALID_PERD		 /* 적용포인트유효기간 */
                    , FTGABLT_STA_HOUR                    /*피로도시작시간        */
                    , FTGABLT_END_HOUR                    /*피로도종료시간        */
                    , FTGABLT_STA_MNUT                    /*피로도시작시간        */
                    , FTGABLT_END_MNUT                    /*피로도종료시간        */
    </sql>
    
    <sql id="sqlSelectCols">
                      A.CAMP_BAS_NO                    /*캠페인기본번호        */
                    , A.CAMP_TYPE_CD                    /*캠페인유형코드        */
                    , A.QSTNR_BAS_NO                    /*설문기본번호        */
                    , A.CAMP_SHAP_CD                    /*캠페인형태코드        */
                    , A.CAMP_EXEC_CNT                    /*캠페인실행수        */
                    , A.CAMP_COND_CD                    /*캠페인조건코드        */
                    , A.PRNTS_CAMP_BAS_NO                    /*부모캠페인기본번호        */
                    , A.FROM_APPLY_SALE_AMT                    /*FROM적용매출금액        */
                    , A.TO_APPLY_SALE_AMT                    /*TO적용매출금액        */
                    , A.FROM_APPLY_SALE_COND_CD                    /*FROM적용매출조건코드        */
                    , A.TO_APPLY_SALE_COND_CD                    /*TO적용매출조건코드        */
                    , A.FROM_APPLY_SNCT_AMT                    /*FROM적용결재금액        */
                    , A.TO_APPLY_SNCT_AMT                    /*TO적용결재금액        */
                    , A.FROM_APPLY_PAY_COND_CD                    /*FROM적용결제조건코드        */
                    , A.TO_APPLY_PAY_COND_CD                    /*TO적용결제조건코드        */
                    , A.APPLY_MSHIP_GRADE_CD                    /*적용멤버십등급코드        */
                    , TO_CHAR( TO_DATE(A.CAMP_STA_YMD,'YYYYMMDDHH24MISS'),'YYYYMMDD') CAMP_STA_YMD                    /*캠페인시작년월일        */
                    , TO_CHAR( TO_DATE(A.CAMP_END_YMD,'YYYYMMDDHH24MISS'),'YYYYMMDD') CAMP_END_YMD                    /*캠페인종료년월일        */
                    , A.RPEAT_YN                    /*반복여부        */
                    , A.RPEAT_CD                    /*반복코드        */
                    , A.RPEAT_MONTH                    /*반복월        */
                    , A.RPEAT_DAY                    /*반복일        */
                    , A.RPEAT_DOW_PLCY_CD                    /*반복요일정책코드        */
                    , A.CAMP_STATUS_CD                    /*캠페인상태코드        */
                    , A.WHOLE_BDGET_AMT                    /*전체예산금액        */
                    , A.CAMP_FTGABLT_PLCY_CD                    /*캠페인피로도정책코드        */
                    , A.CAMP_BAS_NM                    /*캠페인기본명        */
                    , A.CAMP_BAS_CTNTS                    /*캠페인기본내용        */
                    , A.AMDR_ID                    /*수정자ID        */
                    , TO_CHAR(A.AMD_DT,'YYYYMMDDHH24MISS')    AMD_DT                    /*수정일시        */
                    , A.REGR_ID                    /*등록자ID        */
                    , TO_CHAR(A.REG_DT,'YYYYMMDDHH24MISS')    REG_DT                    /*등록일시        */
                    , A.REG_CHL_CD                    /*등록채널코드        공통코드 : S000        [CRM : CRM , CTC : 상담 , AS : AS , SAP : SAP , POS : POS , BOS : BOS , MEM : 멤버십 , CERA : 세라체크 , DNA : 세라DNA , IoT : IoT]*/
                    , A.ORDR_CHL_LIST                    /*주문채널리스트        */
                    , A.DSP_HOUR                    /*발송시간        */
                    , A.DOW_1_USE_YN                    /*월요일사용여부        */
                    , A.DOW_2_USE_YN                    /*화요일사용여부        */
                    , A.DOW_3_USE_YN                    /*수요일사용여부        */
                    , A.DOW_4_USE_YN                    /*목요일사용여부        */
                    , A.DOW_5_USE_YN                    /*금요일사용여부        */
                    , A.DOW_6_USE_YN                    /*토요일사용여부        */
                    , A.DOW_7_USE_YN                    /*일요일사용여부        */
                    , (SELECT COMN_CD_NM FROM CRM_COMN_CD_BAS B WHERE B.TOP_COMN_CD = 'CM020' and B.COMN_CD = A.CAMP_SHAP_CD ) CAMP_SHAP_CD_NM    /* 등급명        */
                    , (SELECT COMN_CD_NM FROM CRM_COMN_CD_BAS B WHERE B.TOP_COMN_CD = 'CM050' and B.COMN_CD = A.RPEAT_CD ) RPEAT_CD_NM    /* 반복주기명        */
                    , (SELECT COMN_CD_NM FROM CRM_COMN_CD_BAS B WHERE B.TOP_COMN_CD = 'CM040' and B.COMN_CD = A.CAMP_STATUS_CD ) CAMP_STATUS_CD_NM    /* 캠페인상태        */
                    , (SELECT COUPN_BAS_NM FROM CRM_MSHIP_COUPN_BAS B WHERE  B.MSHIP_COUPN_BAS_NO = A.APPLY_COUPN_BAS_NO ) APPLY_COUPN_BAS_NO_NM    /* 캠페인상태        */
                    
                    , NVL(APPLY_POINT, 0) APPLY_POINT
                    , APPLY_CUST_CNT
                    , APPLY_COUPN_BAS_NO
                    , APPLY_GRP_NO
                    
                    
                    , DSP_CHL_CD							
                    , DSP_CTNT_TYPE_NO	
                    , A.APPLY_POINT_STA_YMD                    /*포인트유효기간시작년월일        */
                    , A.APPLY_POINT_END_YMD                    /*포인트유효기간종료년월일        */
                    
					, A.SALE_OCCUR_STA_YMD                    /*매출발생시작년월일        */
                    , A.SALE_OCCUR_END_YMD                    /*매출발생종료년월일        */
                    , A.END_AFTR_DAY_CNT                    /*종료후일수        */
                    
                        , A.LOW_RSPN_CAMP_NO                    /*하위캠페인기본번호        */
                    , A.LOW_RSPN_DNA_CAMP_NO                    /*하위반응미적용캠페인번호        */
                    , A.RSPN_APPLY_YN
                     , A.DAY_GAP_CNT                    /*일차이수        */
                     
                    , NVL(A.COUPN_ISSUE_CNT, 0) COUPN_ISSUE_CNT			   /* 쿠폰발행수 */
                    , NVL(A.APPLY_POINT_VALID_PERD, 0)	APPLY_POINT_VALID_PERD		  /*  적용포인트유효기간 */
                     
                     
                    , NVL(A.FTGABLT_STA_HOUR, '09') FTGABLT_STA_HOUR                    /*피로도시작시간        */
                    , NVL(A.FTGABLT_END_HOUR, '18') FTGABLT_END_HOUR                    /*피로도종료시간        */
                    , NVL(A.FTGABLT_STA_MNUT, '00') FTGABLT_STA_MNUT                    /*피로도시작시간        */
                    , NVL(A.FTGABLT_END_MNUT, '00') FTGABLT_END_MNUT                    /*피로도종료시간        */
                     
                    
                    , (CASE WHEN A.PRNTS_CAMP_BAS_NO IS NULL THEN '1차' ELSE '2차' END) CAMP_TMS_NM
                     
                    , (SELECT COMN_CD_NM FROM CRM_COMN_CD_BAS B WHERE B.TOP_COMN_CD = 'CM070' and B.COMN_CD = A.RSPN_APPLY_YN ) RSPN_APPLY_YN_NM    /* 반응형 사용유무        */				
                    , NULL DSP_CTNT_TYPE_NO_NM				
                    , (SELECT COMN_CD_NM FROM CRM_COMN_CD_BAS B WHERE B.TOP_COMN_CD = 'CM010' and B.COMN_CD = A.CAMP_TYPE_CD ) CAMP_TYPE_CD_NM
                    
                    , (
	                    SELECT /* com.ceragem.crm.cst.dao.crmCampBas.select */
							 CUST_GRP_NM || ' (' || (
								SELECT 
									COUNT(*)
								FROM CRM_CAMP_TGTR_BAS 
                                WHERE CAMP_BAS_NO = A.CAMP_BAS_NO
							) || '명)' 
						FROM CRM_CUST_GRP_BAS grpBas
			           where CUST_GRP_NO = A.APPLY_GRP_NO
          			) APPLY_GRP_NO_NM
          			
          			, 0 AS DR_RSPN_CNT       /* 직접반응수 */
          			, (SELECT COUNT(*) FROM CRM_CUST_BOS_CNTRT_HST WHERE CAMP_BAS_NO = A.CAMP_BAS_NO) AS INDIR_RSPN_CNT    /* 간접반응수 */
          		 	, NULL SEND_TYPE
          		 	
          			
		            
    </sql>
    <sql id="sqlConditions">
         <where>
        <if test="campBasNo != null and campBasNo != ''">
                  AND A.CAMP_BAS_NO     =       #{campBasNo}
        </if>
        <if test="campTypeCd != null and campTypeCd != ''">
            <choose>
                <when test="campTypeCd instanceof String">
                    AND A.CAMP_TYPE_CD    =       #{campTypeCd}
                </when>
                <otherwise>
                    AND A.CAMP_TYPE_CD    IN
                    <foreach item="item" index="index" collection="campTypeCd" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </otherwise>
            </choose>
        </if>
        <if test="qstnrBasNo != null and qstnrBasNo != ''">
                  AND A.QSTNR_BAS_NO    =       #{qstnrBasNo}
        </if>
        <if test="campShapCd != null and campShapCd != ''">
            <choose>
                <when test="campShapCd instanceof String">
                    AND A.CAMP_SHAP_CD    =       #{campShapCd}
                </when>
                <otherwise>
                    AND A.CAMP_SHAP_CD    IN
                    <foreach item="item" index="index" collection="campShapCd" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </otherwise>
            </choose>
        </if>
        <if test="campExecCnt != null and campExecCnt != ''">
                  AND A.CAMP_EXEC_CNT   =       #{campExecCnt}
        </if>
        <if test="campCondCd != null and campCondCd != ''">
            <choose>
                <when test="campCondCd instanceof String">
                    AND A.CAMP_COND_CD    =       #{campCondCd}
                </when>
                <otherwise>
                    AND A.CAMP_COND_CD    IN
                    <foreach item="item" index="index" collection="campCondCd" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </otherwise>
            </choose>
        </if>
        <if test="prntsCampBasNo != null and prntsCampBasNo != ''">
                  AND A.PRNTS_CAMP_BAS_NO=       #{prntsCampBasNo}
        </if>
        <if test="fromApplySaleAmt != null and fromApplySaleAmt != ''">
                  AND A.FROM_APPLY_SALE_AMT=       #{fromApplySaleAmt}
        </if>
        <if test="toApplySaleAmt != null and toApplySaleAmt != ''">
                  AND A.TO_APPLY_SALE_AMT=       #{toApplySaleAmt}
        </if>
        <if test="fromApplySaleCondCd != null and fromApplySaleCondCd != ''">
            <choose>
                <when test="fromApplySaleCondCd instanceof String">
                    AND A.FROM_APPLY_SALE_COND_CD=       #{fromApplySaleCondCd}
                </when>
                <otherwise>
                    AND A.FROM_APPLY_SALE_COND_CDIN
                    <foreach item="item" index="index" collection="fromApplySaleCondCd" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </otherwise>
            </choose>
        </if>
        <if test="toApplySaleCondCd != null and toApplySaleCondCd != ''">
            <choose>
                <when test="toApplySaleCondCd instanceof String">
                    AND A.TO_APPLY_SALE_COND_CD=       #{toApplySaleCondCd}
                </when>
                <otherwise>
                    AND A.TO_APPLY_SALE_COND_CDIN
                    <foreach item="item" index="index" collection="toApplySaleCondCd" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </otherwise>
            </choose>
        </if>
        <if test="fromApplySnctAmt != null and fromApplySnctAmt != ''">
                  AND A.FROM_APPLY_SNCT_AMT=       #{fromApplySnctAmt}
        </if>
        <if test="toApplySnctAmt != null and toApplySnctAmt != ''">
                  AND A.TO_APPLY_SNCT_AMT=       #{toApplySnctAmt}
        </if>
        <if test="fromApplyPayCondCd != null and fromApplyPayCondCd != ''">
            <choose>
                <when test="fromApplyPayCondCd instanceof String">
                    AND A.FROM_APPLY_PAY_COND_CD=       #{fromApplyPayCondCd}
                </when>
                <otherwise>
                    AND A.FROM_APPLY_PAY_COND_CDIN
                    <foreach item="item" index="index" collection="fromApplyPayCondCd" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </otherwise>
            </choose>
        </if>
        <if test="toApplyPayCondCd != null and toApplyPayCondCd != ''">
            <choose>
                <when test="toApplyPayCondCd instanceof String">
                    AND A.TO_APPLY_PAY_COND_CD=       #{toApplyPayCondCd}
                </when>
                <otherwise>
                    AND A.TO_APPLY_PAY_COND_CDIN
                    <foreach item="item" index="index" collection="toApplyPayCondCd" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </otherwise>
            </choose>
        </if>
        <if test="applyMshipGradeCd != null and applyMshipGradeCd != ''">
            <choose>
                <when test="applyMshipGradeCd instanceof String">
                    AND A.APPLY_MSHIP_GRADE_CD=       #{applyMshipGradeCd}
                </when>
                <otherwise>
                    AND A.APPLY_MSHIP_GRADE_CDIN
                    <foreach item="item" index="index" collection="applyMshipGradeCd" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </otherwise>
            </choose>
        </if>
        
        <if test="campStaYmd != null and campStaYmd != '' and campEndYmd == null and campEndYmd == ''">
                  AND A.CAMP_STA_YMD  <![CDATA[<=]]>      #{campStaYmd}
        </if>
        
        <if test="campStaYmd == null and campStaYmd == '' and campEndYmd != null and campEndYmd != ''">
                  AND A.CAMP_END_YMD  <![CDATA[>=]]>   #{campEndYmd}
        </if>
        
        <if test="campStaYmd != null and campStaYmd != '' and campEndYmd != null and campEndYmd != '' ">
                  AND ( A.CAMP_STA_YMD  <![CDATA[<=]]>   #{campStaYmd}  AND A.CAMP_END_YMD  <![CDATA[>=]]>  #{campEndYmd} )
        </if>
        
        
        
        
        
        
        
        
        
        
        <if test="rpeatYn != null and rpeatYn != ''">
                  AND A.RPEAT_YN        =       #{rpeatYn}
        </if>
        <if test="rpeatCd != null and rpeatCd != ''">
            <choose>
                <when test="rpeatCd instanceof String">
                    AND A.RPEAT_CD        =       #{rpeatCd}
                </when>
                <otherwise>
                    AND A.RPEAT_CD        IN
                    <foreach item="item" index="index" collection="rpeatCd" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </otherwise>
            </choose>
        </if>
        <if test="rpeatMonth != null and rpeatMonth != ''">
                  AND A.RPEAT_MONTH     =       #{rpeatMonth}
        </if>
        <if test="rpeatDay != null and rpeatDay != ''">
                  AND A.RPEAT_DAY       =       #{rpeatDay}
        </if>
        <if test="rpeatDowPlcyCd != null and rpeatDowPlcyCd != ''">
            <choose>
                <when test="rpeatDowPlcyCd instanceof String">
                    AND A.RPEAT_DOW_PLCY_CD=       #{rpeatDowPlcyCd}
                </when>
                <otherwise>
                    AND A.RPEAT_DOW_PLCY_CDIN
                    <foreach item="item" index="index" collection="rpeatDowPlcyCd" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </otherwise>
            </choose>
        </if>
        <if test="campStatusCd != null and campStatusCd != ''">
            <choose>
                <when test="campStatusCd instanceof String">
                    AND A.CAMP_STATUS_CD  =       #{campStatusCd}
                </when>
                <otherwise>
                    AND A.CAMP_STATUS_CD  IN
                    <foreach item="item" index="index" collection="campStatusCd" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </otherwise>
            </choose>
        </if>
        <if test="wholeBdgetAmt != null and wholeBdgetAmt != ''">
                  AND A.WHOLE_BDGET_AMT =       #{wholeBdgetAmt}
        </if>
        <if test="campFtgabltPlcyCd != null and campFtgabltPlcyCd != ''">
            <choose>
                <when test="campFtgabltPlcyCd instanceof String">
                    AND A.CAMP_FTGABLT_PLCY_CD=       #{campFtgabltPlcyCd}
                </when>
                <otherwise>
                    AND A.CAMP_FTGABLT_PLCY_CDIN
                    <foreach item="item" index="index" collection="campFtgabltPlcyCd" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </otherwise>
            </choose>
        </if>
        <if test="campBasNm != null and campBasNm != ''">
                  AND A.CAMP_BAS_NM  LIKE  '%'|| #{campBasNm} ||'%'
        </if>
        <if test="campBasCtnts != null and campBasCtnts != ''">
                  AND A.CAMP_BAS_CTNTS  =       #{campBasCtnts}
        </if>
        <if test="regChlCd != null and regChlCd != ''">
            <choose>
                <when test="regChlCd instanceof String">
                    AND A.REG_CHL_CD      =       #{regChlCd}
                </when>
                <otherwise>
                    AND A.REG_CHL_CD      IN
                    <foreach item="item" index="index" collection="regChlCd" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </otherwise>
            </choose>
        </if>
        <if test="ordrChlList != null and ordrChlList != ''">
                  AND A.ORDR_CHL_LIST   =       #{ordrChlList}
        </if>
        <if test="dspHour != null and dspHour != ''">
                  AND A.DSP_HOUR        =       #{dspHour}
        </if>
        <if test="dow1UseYn != null and dow1UseYn != ''">
                  AND A.DOW_1_USE_YN    =       #{dow1UseYn}
        </if>
        <if test="dow2UseYn != null and dow2UseYn != ''">
                  AND A.DOW_2_USE_YN    =       #{dow2UseYn}
        </if>
        <if test="dow3UseYn != null and dow3UseYn != ''">
                  AND A.DOW_3_USE_YN    =       #{dow3UseYn}
        </if>
        <if test="dow4UseYn != null and dow4UseYn != ''">
                  AND A.DOW_4_USE_YN    =       #{dow4UseYn}
        </if>
        <if test="dow5UseYn != null and dow5UseYn != ''">
                  AND A.DOW_5_USE_YN    =       #{dow5UseYn}
        </if>
        <if test="dow6UseYn != null and dow6UseYn != ''">
                  AND A.DOW_6_USE_YN    =       #{dow6UseYn}
        </if>
        <if test="dow7UseYn != null and dow7UseYn != ''">
                  AND A.DOW_7_USE_YN    =       #{dow7UseYn}
        </if>
        </where>
    </sql>
    <sql id="sqlOrderBy">
        <choose>
            <when test="colSortName ==null or colSortName == ''">
                ORDER BY      REG_DT DESC
            </when>
            <when test="colSortName.equals('campBasNo')">
                ORDER BY      CAMP_BAS_NO
            </when>
            <when test="colSortName.equals('campTypeCd')">
                ORDER BY      CAMP_TYPE_CD
            </when>
            <when test="colSortName.equals('qstnrBasNo')">
                ORDER BY      QSTNR_BAS_NO
            </when>
            <when test="colSortName.equals('campShapCd')">
                ORDER BY      CAMP_SHAP_CD
            </when>
            <when test="colSortName.equals('campExecCnt')">
                ORDER BY      CAMP_EXEC_CNT
            </when>
            <when test="colSortName.equals('campCondCd')">
                ORDER BY      CAMP_COND_CD
            </when>
            <when test="colSortName.equals('prntsCampBasNo')">
                ORDER BY      PRNTS_CAMP_BAS_NO
            </when>
            <when test="colSortName.equals('fromApplySaleAmt')">
                ORDER BY      FROM_APPLY_SALE_AMT
            </when>
            <when test="colSortName.equals('toApplySaleAmt')">
                ORDER BY      TO_APPLY_SALE_AMT
            </when>
            <when test="colSortName.equals('fromApplySaleCondCd')">
                ORDER BY      FROM_APPLY_SALE_COND_CD
            </when>
            <when test="colSortName.equals('toApplySaleCondCd')">
                ORDER BY      TO_APPLY_SALE_COND_CD
            </when>
            <when test="colSortName.equals('fromApplySnctAmt')">
                ORDER BY      FROM_APPLY_SNCT_AMT
            </when>
            <when test="colSortName.equals('toApplySnctAmt')">
                ORDER BY      TO_APPLY_SNCT_AMT
            </when>
            <when test="colSortName.equals('fromApplyPayCondCd')">
                ORDER BY      FROM_APPLY_PAY_COND_CD
            </when>
            <when test="colSortName.equals('toApplyPayCondCd')">
                ORDER BY      TO_APPLY_PAY_COND_CD
            </when>
            <when test="colSortName.equals('applyMshipGradeCd')">
                ORDER BY      APPLY_MSHIP_GRADE_CD
            </when>
            <when test="colSortName.equals('campStaYmd')">
                ORDER BY      CAMP_STA_YMD
            </when>
            <when test="colSortName.equals('campEndYmd')">
                ORDER BY      CAMP_END_YMD
            </when>
            <when test="colSortName.equals('rpeatYn')">
                ORDER BY      RPEAT_YN
            </when>
            <when test="colSortName.equals('rpeatCd')">
                ORDER BY      RPEAT_CD
            </when>
            <when test="colSortName.equals('rpeatMonth')">
                ORDER BY      RPEAT_MONTH
            </when>
            <when test="colSortName.equals('rpeatDay')">
                ORDER BY      RPEAT_DAY
            </when>
            <when test="colSortName.equals('rpeatDowPlcyCd')">
                ORDER BY      RPEAT_DOW_PLCY_CD
            </when>
            <when test="colSortName.equals('campStatusCd')">
                ORDER BY      CAMP_STATUS_CD
            </when>
            <when test="colSortName.equals('wholeBdgetAmt')">
                ORDER BY      WHOLE_BDGET_AMT
            </when>
            <when test="colSortName.equals('campFtgabltPlcyCd')">
                ORDER BY      CAMP_FTGABLT_PLCY_CD
            </when>
            <when test="colSortName.equals('campBasNm')">
                ORDER BY      CAMP_BAS_NM
            </when>
            <when test="colSortName.equals('campBasCtnts')">
                ORDER BY      CAMP_BAS_CTNTS
            </when>
            <when test="colSortName.equals('amdrId')">
                ORDER BY      AMDR_ID
            </when>
            <when test="colSortName.equals('amdDt')">
                ORDER BY      AMD_DT
            </when>
            <when test="colSortName.equals('regrId')">
                ORDER BY      REGR_ID
            </when>
            <when test="colSortName.equals('regDt')">
                ORDER BY      REG_DT
            </when>
            <when test="colSortName.equals('regChlCd')">
                ORDER BY      REG_CHL_CD
            </when>
            <when test="colSortName.equals('ordrChlList')">
                ORDER BY      ORDR_CHL_LIST
            </when>
            <when test="colSortName.equals('dspHour')">
                ORDER BY      DSP_HOUR
            </when>
            <when test="colSortName.equals('dow1UseYn')">
                ORDER BY      DOW_1_USE_YN
            </when>
            <when test="colSortName.equals('dow2UseYn')">
                ORDER BY      DOW_2_USE_YN
            </when>
            <when test="colSortName.equals('dow3UseYn')">
                ORDER BY      DOW_3_USE_YN
            </when>
            <when test="colSortName.equals('dow4UseYn')">
                ORDER BY      DOW_4_USE_YN
            </when>
            <when test="colSortName.equals('dow5UseYn')">
                ORDER BY      DOW_5_USE_YN
            </when>
            <when test="colSortName.equals('dow6UseYn')">
                ORDER BY      DOW_6_USE_YN
            </when>
            <when test="colSortName.equals('dow7UseYn')">
                ORDER BY      DOW_7_USE_YN
            </when>
            <otherwise>
                ORDER BY      REG_DT
            </otherwise>
        </choose>
        <if test="colSortName !=null and colSortDir !='' and colSortDir !=null and colSortDir !='' and colSortDir.equals('desc')">
            DESC
        </if>
    </sql>
    <select id="selectListCount" resultType="int">
                SELECT /* com.ceragem.crm.camp.dao.CrmCampBasDao.selectListCount */ COUNT(1)
                 FROM CRM_CAMP_BAS A
        <include refid="sqlConditions"/>
    </select>
    <select id="selectList" resultType="com.ceragem.crm.camp.model.CrmCampBasVo">
        <include refid="com.ceragem.crm.sys.dao.CrmCommonDao.pagingHeader"/>
               SELECT /* com.ceragem.crm.camp.dao.CrmCampBasDao.selectList */ <include refid="sqlSelectCols"/>
                 FROM CRM_CAMP_BAS A
        <include refid="sqlConditions"/>
        <include refid="sqlOrderBy"/>
        <include refid="com.ceragem.crm.sys.dao.CrmCommonDao.pagingFooter"/>
    </select>
    <select id="select" resultType="com.ceragem.crm.camp.model.CrmCampBasVo">
               SELECT /* com.ceragem.crm.camp.dao.CrmCampBasDao.select */ <include refid="sqlSelectCols"/>
                 FROM CRM_CAMP_BAS A
        <include refid="sqlPkConditions"/>
    </select>
    <insert id="insert">
    
    		<selectKey order="BEFORE" keyColumn="campBasNo" keyProperty="campBasNo" resultType="String">
    		SELECT FN_CRM_AUTO_SEQ('CBN') campBasNo  FROM DUAL
    		</selectKey>
    		
    		
    		
    		DECLARE BEGIN
    
                INSERT /* com.ceragem.crm.camp.dao.CrmCampBasDao.insert */ INTO CRM_CAMP_BAS (
        <include refid="sqlCols"/>
                 ) VALUES (
                       #{campBasNo}
                     , #{campTypeCd}
                     , #{qstnrBasNo}
                     , #{campShapCd}
                    
                 
                     
                     <if test=' prntsCampBasNo == null  ' >
                     , 1
                     </if>
                     
                     <if test=' prntsCampBasNo != null   ' >
                     , 2
                     </if>
                     
                     
                     , #{campCondCd}
                     , #{prntsCampBasNo}
                     , #{fromApplySaleAmt}
                     , #{toApplySaleAmt}
                     , #{fromApplySaleCondCd}
                     , #{toApplySaleCondCd}
                     , #{fromApplySnctAmt}
                     , #{toApplySnctAmt}
                     , #{fromApplyPayCondCd}
                     , #{toApplyPayCondCd}
                     , #{applyMshipGradeCd}
                    
                     
                    <if test=' prntsCampBasNo == null  ' >
                     , #{campStaYmd}
                     </if>
                     
                     
                     <if test='  prntsCampBasNo != null and prntsCampBasNo != ""  and endAftrDayCnt != "" ' >  
                     , TO_CHAR( TO_DATE(#{campEndYmd}, 'YYYYMMDD') ,  'YYYYMMDD' )
                     </if>
                     
                  
                     
                     <if test='  prntsCampBasNo != null and prntsCampBasNo != ""  and endAftrDayCnt != "" ' >  
                     , TO_CHAR( TO_DATE(#{campEndYmd}, 'YYYYMMDD')  ,  'YYYYMMDD' )
                     </if>
                     
                     <if test=' prntsCampBasNo == null  ' >
                     , #{campEndYmd}
                     </if>
                     
                     
                     , NVL(#{rpeatYn},'N')
                     , #{rpeatCd}
                     , #{rpeatMonth}
                     , #{rpeatDay}
                     , #{rpeatDowPlcyCd}
                     , #{campStatusCd}
                     , #{wholeBdgetAmt}
                     , #{campFtgabltPlcyCd}
                     , #{campBasNm}
                     , #{campBasCtnts}
                     , #{amdrId}
                     , SYSDATE
                     , #{regrId}
                     , SYSDATE
                     , #{regChlCd}
                     , #{ordrChlList}
                     , #{dspHour}
                     , NVL(#{dow1UseYn},'N')
                     , NVL(#{dow2UseYn},'N')
                     , NVL(#{dow3UseYn},'N')
                     , NVL(#{dow4UseYn},'N')
                     , NVL(#{dow5UseYn},'N')
                     , NVL(#{dow6UseYn},'N')
                     , NVL(#{dow7UseYn},'N')
                     , NVL(#{applyPoint}, 0)
                     , NVL(#{applyCustCnt}, 0)
                     , #{applyCoupnBasNo}
                     , #{applyGrpNo}
                     , #{dspChlCd}
                     , #{dspCtntTypeNo}
                     , #{applyPointStaYmd}
                     , #{applyPointEndYmd}
                     , #{saleOccurStaYmd}
                     , #{saleOccurEndYmd}
                     , #{endAftrDayCnt}
                     , #{lowRspnCampNo}
                     , #{lowRspnDnaCampNo}
                     , #{rspnApplyYn}
                     
                     
                     <if test='  prntsCampBasNo == null  '>
                     , TO_DATE( #{campEndYmd}, 'YYYYMMDD') - TO_DATE( #{campStaYmd} , 'YYYYMMDD')  
                     </if>
                     
                      <if test=' prntsCampBasNo != null and  dayGapCnt != null and dayGapCnt !=""   '>
                     ,  #{dayGapCnt} 
                     </if>
                     
                     , #{coupnIssueCnt}
                     , #{applyPointValidPerd}
                     , #{ftgabltStaHour}
                     , #{ftgabltEndHour}
                     , #{ftgabltStaMnut}
                     , #{ftgabltEndMnut}
                     
                 );
                 
             <if test=' ( prntsCampBasNo !=null and prntsCampBasNo !="" ) and rspnApplyYn == "Y"  '>
           		 UPDATE /* CrmCampBasDao 부모 캠페인에 하위 캠페인 코드 업데이트 - 반응 */  CRM_CAMP_BAS SET LOW_RSPN_CAMP_NO = #{campBasNo} WHERE CAMP_BAS_NO = #{prntsCampBasNo};
       		 </if>
       		 
       		 <if test=' ( prntsCampBasNo !=null and prntsCampBasNo !="" ) and rspnApplyYn == "N"  '>
           		 UPDATE /* CrmCampBasDao 부모 캠페인에 하위 캠페인 코드 업데이트 - 미반응 */  CRM_CAMP_BAS SET LOW_RSPN_DNA_CAMP_NO = #{campBasNo} WHERE CAMP_BAS_NO = #{prntsCampBasNo};
       		 </if>
       		 
       		 END;
        
    </insert>
    <update id="update">
               UPDATE /* com.ceragem.crm.camp.dao.CrmCampBasDao.update */ CRM_CAMP_BAS
                  SET CAMP_TYPE_CD                            =         #{campTypeCd}
                    , QSTNR_BAS_NO                            =         #{qstnrBasNo}
                    , CAMP_SHAP_CD                            =         #{campShapCd}
                    , CAMP_EXEC_CNT                           =         #{campExecCnt}
                    , CAMP_COND_CD                            =         #{campCondCd}
                    , PRNTS_CAMP_BAS_NO                       =         #{prntsCampBasNo}
                    , FROM_APPLY_SALE_AMT                     =         #{fromApplySaleAmt}
                    , TO_APPLY_SALE_AMT                       =         #{toApplySaleAmt}
                    , FROM_APPLY_SALE_COND_CD                 =         #{fromApplySaleCondCd}
                    , TO_APPLY_SALE_COND_CD                   =         #{toApplySaleCondCd}
                    , FROM_APPLY_SNCT_AMT                     =         #{fromApplySnctAmt}
                    , TO_APPLY_SNCT_AMT                       =         #{toApplySnctAmt}
                    , FROM_APPLY_PAY_COND_CD                  =         #{fromApplyPayCondCd}
                    , TO_APPLY_PAY_COND_CD                    =         #{toApplyPayCondCd}
                    , APPLY_MSHIP_GRADE_CD                    =         #{applyMshipGradeCd}
                    , CAMP_STA_YMD                            =         #{campStaYmd}
                    , CAMP_END_YMD                            =         #{campEndYmd}
                    , RPEAT_YN                                =         NVL(#{rpeatYn},'N')
                    , RPEAT_CD                                =         #{rpeatCd}
                    , RPEAT_MONTH                             =         #{rpeatMonth}
                    , RPEAT_DAY                               =         #{rpeatDay}
                    , RPEAT_DOW_PLCY_CD                       =         #{rpeatDowPlcyCd}
                    , CAMP_STATUS_CD                          =         #{campStatusCd}
                    , WHOLE_BDGET_AMT                         =         #{wholeBdgetAmt}
                    , CAMP_FTGABLT_PLCY_CD                    =         #{campFtgabltPlcyCd}
                    , CAMP_BAS_NM                             =         #{campBasNm}
                    , CAMP_BAS_CTNTS                          =         #{campBasCtnts}
                    , AMDR_ID                                 =         #{amdrId}
                    , AMD_DT                                  =         SYSDATE
                    , REG_CHL_CD                              =         #{regChlCd}
                    , ORDR_CHL_LIST                           =         #{ordrChlList}
                    , DSP_HOUR                                =         #{dspHour}
                    , DOW_1_USE_YN                            =         NVL(#{dow1UseYn},'N')
                    , DOW_2_USE_YN                            =         NVL(#{dow2UseYn},'N')
                    , DOW_3_USE_YN                            =         NVL(#{dow3UseYn},'N')
                    , DOW_4_USE_YN                            =         NVL(#{dow4UseYn},'N')
                    , DOW_5_USE_YN                            =         NVL(#{dow5UseYn},'N')
                    , DOW_6_USE_YN                            =         NVL(#{dow6UseYn},'N')
                    , DOW_7_USE_YN                            =         NVL(#{dow7UseYn},'N')
                    , APPLY_POINT                             =         #{applyPoint}
                    , APPLY_CUST_CNT                          =         #{applyCustCnt}
                    , APPLY_COUPN_BAS_NO                      =         #{applyCoupnBasNo}
                    , APPLY_GRP_NO                            =         #{applyGrpNo}
                    , DSP_CHL_CD							  =         #{dspChlCd}
                    , DSP_CTNT_TYPE_NO						  =         #{dspCtntTypeNo}
                    , APPLY_POINT_STA_YMD                     =         #{applyPointStaYmd}
                    , APPLY_POINT_END_YMD                     =         #{applyPointEndYmd}
                    , SALE_OCCUR_STA_YMD                      =         #{saleOccurStaYmd}
                    , SALE_OCCUR_END_YMD                      =         #{saleOccurEndYmd}
                    , END_AFTR_DAY_CNT                        =         #{endAftrDayCnt}
                   
                    , LOW_RSPN_CAMP_NO                        =         #{lowRspnCampNo}
                    , LOW_RSPN_DNA_CAMP_NO                    =         #{lowRspnDnaCampNo} 
                    , DAY_GAP_CNT                             =         TO_DATE( #{campEndYmd}, 'YYYYMMDD') - TO_DATE( #{campStaYmd} , 'YYYYMMDD')     
                    
                    , COUPN_ISSUE_CNT                    =         #{coupnIssueCnt} 
                    , APPLY_POINT_VALID_PERD			 =         #{applyPointValidPerd} 
                     , FTGABLT_STA_HOUR                        =         #{ftgabltStaHour}
                    , FTGABLT_END_HOUR                        =         #{ftgabltEndHour}
                    , FTGABLT_STA_MNUT                        =         #{ftgabltStaMnut}
                    , FTGABLT_END_MNUT                        =         #{ftgabltEndMnut}
        <include refid="sqlPkConditions"/>
    </update>
    <delete id="delete">
         DELETE /* com.ceragem.crm.camp.dao.CrmCampBasDao.delete */
                 FROM CRM_CAMP_BAS
        <include refid="sqlPkConditions"/>
    </delete>
    
    
    <update id="saveBenfit">
    	  UPDATE /* com.ceragem.crm.camp.dao.CrmCampBasDao.saveBenfit */ CRM_CAMP_BAS SET
    	  		  APPLY_POINT 		= #{applyPoint}
    	  		, APPLY_CUST_CNT 	= #{applyCustCnt}
    	  		, APPLY_COUPN_BAS_NO = #{applyCoupnBasNo}
    	   WHERE CAMP_BAS_NO  =  #{campBasNo}
    </update>
    
    
    <update id="updateCampStatus">
    	  UPDATE /* com.ceragem.crm.camp.dao.CrmCampBasDao.updateCampStatus */ CRM_CAMP_BAS SET
    	  		  CAMP_STATUS_CD = #{campStatusCd}
    	   WHERE CAMP_BAS_NO  =  #{campBasNo}
    </update>
    
    
     <select id="getIndirectUserList" resultType="com.ceragem.crm.camp.model.CrmCampBasVo">
               SELECT
                      CNTR_NO                    /*계약번호        */
                    , CUST_NO                    /*고객번호        */
                    , CUST_NM                    /*고객명        */
                    , ITG_CUST_NO                    /*계약자 통합고객번호        */
                    , CUST_TY_CD                    /*고객유형코드        */
                    , CUST_TY_CDNM                    /*고객유형명        */
                    , CUST_TY_DTL_CD                    /*고객유형상세코드        */
                    , CUST_TY_DTL_CDNM                    /*고객유형상세명        */
                    , ORD_NO                    /*주문번호        */
                    , ORD_NO_SN                    /*주문번호순번        */
                    , ORD_DE                    /*주문일자        */
                    , ORD_STS_CD                    /*주문상태코드        */
                    , ORD_STS_CDNM                    /*주문상태명        */
                    , ORD_CHN_CD                    /*주문채널코드        */
                    , ORD_SE_CD                    /*주문구분코드        */
                    , ORD_SE_CDNM                    /*주문구분명        */
                    , ORD_CNCL_DE                    /*주문취소일자        */
                    , ITEM_CD                    /*품목코드        */
                    , ITEM_NM                    /*품목명        */
                    , ITEM_GRP_CD                    /*품목그룹코드        */
                    , ITEM_GRP_CDNM                    /*품목그룹명        */
                    , ITEM_TY_CD                    /*품목유형코드        */
                    , ITEM_TY_CDNM                    /*품목유형명        */
                    , ITEM_TY_DTL_CD                    /*품목유형상세코드        */
                    , ITEM_TY_DTL_CDNM                    /*품목유형상세명        */
                    , SERIAL_NO                    /*시리얼번호        */
                    , SALE_TY_CD                    /*판매유형코드        */
                    , SALE_TY_CDNM                    /*판매유형명        */
                    , SALE_SE_CD                    /*판매구분코드        */
                    , SALE_SE_CDNM                    /*판매구분명        */
                    , SALE_GRP_CD                    /*판매그룹코드        */
                    , SALE_GRP_CDNM                    /*판매그룹명        */
                    , CNTR_STS_CD                    /*계약상태코드        */
                    , CNTR_STS_CDNM                    /*계약상태명        */
                    , CNTR_STS_DTL_CD                    /*계약상태상세코드        */
                    , CNTR_STS_DTL_CDNM                    /*계약상태상세명        */
                    , CNTR_STS_DTL_RSN                    /*계약상태상세사유        */
                    , SETL_STS_CD                    /*결제상태코드        */
                    , SETL_STS_CDNM                    /*결제상태명        */
                    , IST_STS_CD                    /*설치상태코드        */
                    , IST_STS_CDNM                    /*설치상태명        */
                    , CNTR_CNCL_YN                    /*계약취소여부        */
                    , CNTR_CNCL_DE                    /*계약취소일자        */
                    , CNTR_CNCL_RSN                    /*계약취소사유        */
                    , HQ_SE_CD                    /*본부구분코드        */
                    , SELLER                    /*판매인        */
                    , SELLERNM                    /*판매인명        */
                    , SALE_ORGZ                    /*판매조직        */
                    , IST_DUE_ORGZ                    /*설치예정조직        */
                    , IST_DUE_ENGR                    /*설치예정기사        */
                    , IST_ORGZ                    /*설치조직        */
                    , IST_ENGR                    /*설치기사        */
                    , EQP_NO                    /*설비번호        */
                    , WRH_CD                    /*창고코드        */
                    , WRH_NM                    /*창고명        */
                    , CNTC_SN                    /*컨택순번        */
                    , CUST_CNTC_STS                    /*고객컨택상태        */
                    , CUST_CNTC_DE                    /*고객컨택일자        */
                    , IST_REQ_DE                    /*설치요청일자        */
                    , IST_DE                    /*설치일자        */
                    , IST_DCS_YN                    /*설치확정여부        */
                    , IST_DCS_DE                    /*설치확정일자        */
                    , CNTR_START_DE                    /*계약시작일자        */
                    , CNTR_END_DUE_DE                    /*계약종료예정일자        */
                    , CNTR_END_YN                    /*계약종료여부        */
                    , CNTR_END_DE                    /*계약종료일자        */
                    , SELNG_DCS_YN                    /*매출확정여부        */
                    , SELNG_DCS_DE                    /*매출확정일자        */
                    , CDT_SEL_YN                    /*신용조회여부        */
                    , PRC_PLC_NO                    /*가격정책번호        */
                    , AGR_PD_CD                    /*약정기간코드        */
                    , AGR_PD_CDNM                    /*약정기간명        */
                    , CNTR_PD_VAL                    /*계약기간값        */
                    , SVC_PD_CD                    /*서비스기간코드        */
                    , SVC_CYCLE                    /*점검주기        */
                    , PREPAY_YN                    /*선납여부        */
                    , PREPAY_AMT                    /*선납금액        */
                    , PREPAY_CYCLE                    /*선납주기        */
                    , PREPAY_DCRT                    /*선납할인율        */
                    , REGFEE                    /*등록비        */
                    , ISTCT                    /*설치비        */
                    , DFEE                    /*해체비        */
                    , BASS_RENT_AMT                    /*기본렌탈금액        */
                    , RENT_AMT                    /*렌탈금액        */
                    , BASS_SALE_AMT                    /*기본판매금액        */
                    , SALES_AMT                    /*판매금액        */
                    , SETL_AMT                    /*결제금액        */
                    , ORD_AMT                    /*주문금액        */
                    , ORD_VAT_EXCL_AMT                    /*주문부가세제외금액        */
                    , ORD_VAT_AMT                    /*주문부가세금액        */
                    , SELNG_AMT                    /*매출금액        */
                    , SELNG_VAT_EXCL_AMT                    /*매출부가세제외금액        */
                    , SELNG_VAT_AMT                    /*매출부가세금액        */
                    , SELNG_NO                    /*매출번호        */
                    , VAT_CD                    /*부가세코드        */
                    , SALE_CHN_CD                    /*판매채널코드        */
                    , SALE_CHN_CDNM                    /*판매채널명        */
                    , PRMT_YN                    /*프로모션여부        */
                    , PRMT_PLC_NO                    /*프로모션정책번호        */
                    , PRMT_NO                    /*프로모션번호        */
                    , PKG_YN                    /*패키지여부        */
                    , PKG_PLC_NO                    /*패키지정책번호        */
                    , PKG_NO                    /*패키지번호        */
                    , GRP_YN                    /*단체여부        */
                    , GRP_CD                    /*단체코드        */
                    , GRP_NO                    /*단체번호        */
                    , CTRTC_FILE_NO                    /*계약서파일번호        */
                    , SIGN_FILE_NO                    /*서명파일번호        */
                    , SVC_YN                    /*서비스여부        */
                    , EXIST_CNTR_NO                    /*기존계약번호        */
                    , RTGD_TY_CD                    /*반품유형코드        */
                    , RTGD_REQ_DE                    /*반품요청일자        */
                    , RTGD_DCS_YN                    /*반품접수확정여부        */
                    , RTGD_END_DE                    /*반품완료일자        */
                    , SPLT_PLC_NO                    /*약관정책번호        */
                    , IST_DUE_DE                    /*설치예정일자        */
                    , ADD_PRUF_FILE_NO1                    /*추가증빙파일번호1        */
                    , ADD_PRUF_FILE_NO2                    /*추가증빙파일번호2        */
                    , CDT_GRAD_CD                    /*신용등급코드        */
                    , REG_USR_ID                    /*등록자ID        */
                    , REG_DT                    /*등록일시        */
                    , UPD_USR_ID                    /*수정자ID        */
                    , UPD_DT                    /*수정일시        */
                    , POST_NO                    /*설치-우편번호        */
                    , BASS_ADDR                    /*설치-기본주소        */
                    , DTL_ADDR                    /*설치-상세주소        */
                    , MOB_NO                    /*설치-모바일번호        */
                    , TEL_NO                    /*설치-전화번호        */
                    , PARTCLR_MATTER                    /*설치-특이사항        */
                    , IST_CUST_NM                    /*설치-설치고객명        */
                    , CARD_NO                    /*정기결제-카드번호        */
                    , CDCMP_CD                    /*정기결제-카드사코드        */
                    , OWNER_NM                    /*정기결제-소유주명        */
                    , FSETL_MTH_CD                    /*정기결제-방법코드        */
                    , FSETL_MTH_CDNM                    /*정기결제-방법명        */
                    , FSETL_DE_CD                    /*정기결제일자코드        */
                    , ACCT_AFILE_NO                    /*계좌신청동의파일번호        */
                    , OTBN_STS_CD                    /*출고상태코드        */
                    , OTBN_STS_CDNM                    /*출고상태명        */
                    , RM                    /*비고        */
                    , BASS_MBRSH_AMT                    /*기본멤버십금액        */
                    , MBRSH_AMT                    /*멤버십금액        */
                    , LMPS_FREE_END_DUE_DE                    /*일시불무상종료예정일        */
                    , PKG_TRMN_YN                    /*패키지해지여부        */
                    , DLV_TY_CD                    /*배송유형코드        */
                    , DLV_TY_CDNM                    /*배송유형명        */
                    , DLV_TY_DTL_CD                    /*배송유형상세코드        */
                    , DLV_TY_DTL_CDNM                    /*배송유형상세명        */
                    , AGR_PD_VAL                    /*약정기간값        */
                    , CNTR_PD_SE_CD                    /*계약기간구분코드        */
                    , CNTR_PD_SE_CDNM                    /*계약기간구분명        */
                    , CNTR_END_AFTER_PROC_MTH_CD                    /*계약이후처리방법코드        */
                    , CNTR_END_AFTER_PROC_MTH_CDNM                    /*계약종료이후처리방법        */
                    , UATC_SE_CD                    /*중고구분코드        */
                    , UATC_SE_CDNM                    /*중고구분명        */
                    , UATC_GRAD_CD                    /*중고등급코드        */
                    , UATC_GRAD_CDNM                    /*중고등급명        */
                    , SHDE_CRE_YN                    /*스케줄생성여부        */
                    , RENT_SE_CD                    /*렌탈구분코드        */
                    , RENT_SE_CDNM                    /*렌탈구분명        */
                    , EXPRN_DMD_DC_PD_CD                    /*홈체험청구할인기간코드        */
                    , EXPRN_DMD_DC_PD_CDNM                    /*홈체험청구할인기간명        */
                    , EXPRN_CNTR_NO                    /*홈체험계약번호        */
                    , RCMDR                    /*추천인        */
                    , RCMDRNM                    /*추천인명        */
                    , ORGZ_CD                    /*추천인조직코드        */
                    , ORGZ_NM                    /*추천인조직명        */
                    , SELF_BSN_SE_CD                    /*본인영업구분코드        */
                    , SELF_BSN_SE_CDNM                    /*본인영업구분명        */
                    , PRSNT_DTLS                    /*사은품내역        */
                    , FREE_SALE_TY                    /*무상판매유형        */
                    , FREE_SALE_TYNM                    /*무상판매유형명        */
                    , MNG_NO                    /*관리번호        */
                    , CNTC_STS_CDNM                    /*컨택상태명        */
                    , BASS_SALE_FEE                    /*기본판매요금        */
                    , PRC_PLC_NM                    /*가격정책명        */
                    , CNTR_QY                    /*계약수량        */
                    , DCRT                    /*할인율        */
                    , DC_AMT                    /*할인금액        */
                    , ER_CNTR_NO                    /*이지렌탈계약번호        */
                    , RPRSNTV_CNTR_YN                    /*대표번호여부        */
                    , OR_TY_CD                    /*주문유형코드        */
                    , OR_TY_CDNM                    /*주문유형        */
                    , PRSNT_YN                    /*사은품여부        */
                    , PRSNT_CNTR_NO                    /*원계약번호(사은품)        */
                    , CERAM_ORD_NO                    /*건기식주문번호        */
                    , PTAXBIL_YN                    /*선세금계산서발급여부        */
                    , PTAXBIL_DE                    /*선세금계산서기준일자        */
                    , PTAXBIL_CHRGR_SN                    /*선세금계산서담당자        */
                    , CHRGR_EMAIL                    /*담당자이메일        */
                    , CHRGR_CTTPC                    /*담당자연락처        */
                    , CHRGR_DEPT_NM                    /*담당자부서명        */
                    , RCMDR_MBRSH_ID                    /*추천고객멤버십아이디        */
                    , RCMDR_MBRSH_NM                    /*추천고객멤버십이름        */
                    , CFILE_NO                    /*인수서파일번호        */
                    , INS_SER_NO                    /*조견표번호        */
                    , BOND_CD                    /*채권분류코드        */
                    , BOND_CDNM                    /*채권분류명        */
                 FROM 
                 	  CRM_CUST_BOS_CNTRT_HST
     			WHERE
     				  CAMP_BAS_NO = #{campBasNo}
     	
	        <if test="searchCampStaYmd != null and searchCampStaYmd != '' and searchCampEndYmd == '' "> 
	                  AND TO_DATE(ORD_DE,'YYYYMMDD') >= TO_DATE(#{searchCampStaYmd},'YYYYMMDD')
	        </if>
	        
	        <if test="searchCampEndYmd != null and searchCampEndYmd != '' and searchCampStaYmd == '' ">
	                  AND TO_DATE(#{searchCampEndYmd},'YYYYMMDD') + 1 > TO_DATE(ORD_DE,'YYYYMMDD')
	        </if>
	        
	         <if test="searchCampStaYmd != null and searchCampEndYmd != ''">
	                  AND ( TO_DATE(ORD_DE,'YYYYMMDD') >= TO_DATE(#{searchCampStaYmd},'YYYYMMDD') AND  TO_DATE(#{searchCampEndYmd},'YYYYMMDD') + 1 > TO_DATE(ORD_DE,'YYYYMMDD') )
	        </if>
	        
	        
	        <if test="custNm != null and custNm != ''">
	                 <!--  AND CUST_NM     LIKE    '%' ||  #{custNm} || '%' -->
	                  AND CUST_NM     =     #{custNm} 
	        </if>
    </select>
    <select id="getIndirectUserListCount" resultType="int">
                SELECT COUNT(1)
                 FROM CRM_CUST_BOS_CNTRT_HST
        		WHERE CAMP_BAS_NO = #{campBasNo}
    </select>
    
    
    
    
    
    
    <sql id="sqlMsgCols">
                      CLIENT                    /*CLIENT        */
                    , CAMPAIGN_ID                    /*CAMPAIGN_ID        */
                    , MEMBER_SEQ                    /*MEMBER_SEQ        */
                    , SEND_TYPE                    /*SEND_TYPE        */
                    , SUBJECT                    /*SUBJECT        */
                    , MSG                    /*MSG        */
                    , DESTEL                    /*DESTEL        */
                    , SRCTEL                    /*SRCTEL        */
                    , RESERVETIME                    /*RESERVETIME        */
<!--                     , SENDTIME                    /*SENDTIME        */ -->
<!--                     , REVTIME                    /*REVTIME        */ -->
                    , SENDRESULT                    /*SENDRESULT        */
<!--                     , TRANSRESULT                    /*TRANSRESULT        */ -->
                    	 , FILE_CNT                    /*FILE_CNT        */ 
<!--                     , FILE_CNT_REAL                    /*FILE_CNT_REAL        */ -->
                     , FILE_TYPE1                    /*FILE_TYPE1        */
                     , FILE_PATH1                    /*FILE_PATH1        */
<!--                     , FILE_TYPE2                    /*FILE_TYPE2        */ -->
<!--                     , FILE_PATH2                    /*FILE_PATH2        */ -->
<!--                     , FILE_TYPE3                    /*FILE_TYPE3        */ -->
<!--                     , FILE_PATH3                    /*FILE_PATH3        */ -->
<!--                     , INTERFACE_DATE                    /*INTERFACE_DATE        */ -->
<!--                     , INTERFACE_FL                    /*INTERFACE_FL        */ -->
<!--                     , SMS_TEST                    /*SMS_TEST        */ -->
                    , ETC3                    /*ETC3        */
                    , DUMMY1                    /*DUMMY1        */
                    , DUMMY2                    /*DUMMY2        */
                    , DUMMY3                    /*DUMMY3        */
                    , DUMMY4                    /*DUMMY4        */
                    , DUMMY5                    /*DUMMY5        */
                    , DUMMY6                    /*DUMMY6        */
                    , DUMMY7                    /*DUMMY7        */
                    , DUMMY8                    /*DUMMY8        */
                    , DUMMY9                    /*DUMMY9        */
                    , DUMMY10                    /*DUMMY10        */
                    
<!--                     , SENDER_KEY                    /*SENDER_KEY        */ -->
<!--                     , TEMPLATE_CODE                    /*TEMPLATE_CODE        */ -->
                     , K_MSG                    /*K_MSG        */
                     , K_RESERVETIME                    /*K_RESERVETIME        */ 
<!--                     , K_SENDTIME                    /*K_SENDTIME        */ -->
<!--                     , K_RSLTDATE                    /*K_RSLTDATE        */ -->
<!--                     , K_TRANSRESULT                    /*K_TRANSRESULT        */ -->
<!--                      , K_ERR_ISSEND                    /*K_ERR_ISSEND        */ -->
<!--                      , MSG_TYPE                    /*MSG_TYPE        */ -->
<!--                      , KKO_HEADER                    /*KKO_HEADER        */ -->
<!--                      , KKO_BTN_TYPE                    /*KKO_BTN_TYPE        */ -->
<!--                      , KKO_BTN_INFO                    /*KKO_BTN_INFO        */ -->
<!--                      , IMG_URL                    /*IMG_URL        */ -->
<!--                      , IMG_LINK                    /*IMG_LINK        */ -->
<!--                     , K_WIDE                    /*K_WIDE        */ -->
<!--                      , K_TITLE                    /*K_TITLE        */ -->
<!--                      , AD_FLAG                    /*AD_FLAG        */ -->
                    , REV_ID                    /*REV_ID        */
<!--                     , MSG_JDT                    /*MSG_JDT        */ -->

                    , BARCODE_TYPE                    /*BARCODE_TYPE        */
                    , BARCODE_WIDTH                    /*BARCODE_WIDTH        */
                    , BARCODE_HEIGHT                    /*BARCODE_HEIGHT        */
                    , BARCODE_POS_X                    /*BARCODE_POS_X        */
                    , BARCODE_POS_Y                    /*BARCODE_POS_Y        */
                    , BARCODE_VALUE                    /*BARCODE_VALUE        */
                   
    </sql>
    
    
    <insert id="insertMsg">
    
     
     
                INSERT  /* com.ceragem.crm.camp.dao.CrmCampBasDao.insertMsgIf */ INTO EON.MSGR_IF (
        			<include refid="sqlMsgCols"/>
                 ) 
                 
                   SELECT
				    'CRM'
				    , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				    , RPAD( #{itgCustNo}, 10 , 'A' )
				    , 2 SEND_TYPE
				    , C.Z023_TITLE SUBJECT
				    , FN_GET_MSG(
			              #{itgCustNo}
			            , #{custNm}
			            , 'VIP'
			            , ( SELECT COUPN_BAS_NM FROM CRM_MSHIP_COUPN_BAS E WHERE A.APPLY_COUPN_BAS_NO = E.MSHIP_COUPN_BAS_NO )
			            , 

							(
	                        CASE WHEN ( SELECT NVL(USE_STD_DAY_COND_CD, 'N') FROM CRM_MSHIP_COUPN_BAS E WHERE A.APPLY_COUPN_BAS_NO = E.MSHIP_COUPN_BAS_NO ) = 'Y' THEN 
	                           
	                                TO_CHAR( SYSDATE + NVL( 
	                                ( SELECT COUPN_USE_POSS_DAY FROM CRM_MSHIP_COUPN_BAS E WHERE A.APPLY_COUPN_BAS_NO = E.MSHIP_COUPN_BAS_NO )
	                                , 730 ),'YYYY.MM.DD')
	                           
	                        ELSE
	                        
	                           ( SELECT TO_CHAR(  TO_DATE(TO_USE_STD_DAY , 'YYYYMMDD'), 'YYYY.MM.DD')  FROM CRM_MSHIP_COUPN_BAS E WHERE A.APPLY_COUPN_BAS_NO = E.MSHIP_COUPN_BAS_NO )
	                        
	                        END )
	                        
			            , A.APPLY_POINT
			            , '12345678'
			            , C.Z023_CONTENT
			        ) MSG			    
			        , #{testSmsNo} DESTEL
			        , '15775570' SRCTEL   
			        , TO_CHAR( SYSDATE, 'YYYY-MM-DD HH24:MI:SS')  RESERVETIME
			        , '00000' SENDRESULT
			        
			        , ( CASE WHEN C.Z023_BARCODE_ORG_IMG IS NOT NULL THEN 1 ELSE 0 END ) FILE_CNT
			        , ( CASE WHEN C.Z023_BARCODE_ORG_IMG IS NOT NULL THEN 'I' ELSE NULL END ) FILE_TYPE1
                    , (CASE WHEN C.Z023_BARCODE_ORG_IMG IS NOT NULL THEN  '/app/eon/webmgr/app/mmsimg/' || C.Z023_BARCODE_ORG_IMG ELSE NULL END ) FILE_PATH1
			        , 'crm_1' ETC3
			        , NULL DUMMY1
			        , NULL DUMMY2
			        , NULL DUMMY3
			        , NULL DUMMY4
			        , NULL DUMMY5
			        , NULL DUMMY6
			        , NULL DUMMY7
			        , A.CAMP_BAS_NO DUMMY8
			        , NULL DUMMY9
			        , #{itgCustNo} DUMMY10
			        , FN_GET_MSG(
			              #{itgCustNo}
			            , #{custNm}
			            , 'VIP'
			            , ( SELECT COUPN_BAS_NM FROM CRM_MSHIP_COUPN_BAS E WHERE A.APPLY_COUPN_BAS_NO = E.MSHIP_COUPN_BAS_NO )
			            , 


							(
	                        CASE WHEN ( SELECT NVL(USE_STD_DAY_COND_CD, 'N') FROM CRM_MSHIP_COUPN_BAS E WHERE A.APPLY_COUPN_BAS_NO = E.MSHIP_COUPN_BAS_NO ) = 'Y' THEN 
	                           
	                                TO_CHAR( SYSDATE + NVL( 
	                                ( SELECT COUPN_USE_POSS_DAY FROM CRM_MSHIP_COUPN_BAS E WHERE A.APPLY_COUPN_BAS_NO = E.MSHIP_COUPN_BAS_NO )
	                                , 730 ),'YYYY.MM.DD')
	                           
	                        ELSE
	                        
	                           ( SELECT TO_CHAR(  TO_DATE(TO_USE_STD_DAY , 'YYYYMMDD'), 'YYYY.MM.DD')  FROM CRM_MSHIP_COUPN_BAS E WHERE A.APPLY_COUPN_BAS_NO = E.MSHIP_COUPN_BAS_NO )
	                        
	                        END )
	                        
	                        
			            , A.APPLY_POINT
			            , '12345678'
			            , C.Z023_CONTENT
			        ) MSG	
			        , TO_CHAR( SYSDATE, 'YYYY-MM-DD HH24:MI:SS') K_RESERVETIME
			        , #{itgCustNo} REV_ID
			        , NULL Z023_BARCODE_TYPE
			        , NULL Z023_BARCODE_WIDTH
			        , NULL Z023_BARCODE_HEIGHT
			        , NULL Z023_BARCODE_POS_X
			        , NULL Z023_BARCODE_POS_Y
			        , NULL  BARCODE_VALUE

			        FROM CRM_CAMP_BAS A
<!-- 			        LEFT JOIN EON.WSOMZ023 C ON 1=1   AND C.Z023_USRID IN ( 'crm_1', 'EONSMSEMTC' )  -->
<!-- 			        AND C.Z023_DUMMY1 != '07'  -->
			        
			        <choose>
                        <when test="z023Group != '' and z023Group != null ">AND C.Z023_GROUP = ${z023Group}</when>
                        <otherwise>AND 1 = 2</otherwise>
                     </choose>
                     
                   
                     
                   <!--   TO_CHAR(C.Z023_SEQ) = A.DSP_CTNT_TYPE_NO -->
			        WHERE A.CAMP_BAS_NO=#{campBasNo}
<!-- 			        AND A.DSP_CTNT_TYPE_NO = C.Z023_SEQ -->
			          
    				 <if test=" campBasNo == '' || testSmsNo == '' ">  
    				 	AND 1 = 2
    				 </if>
			       
 
         
    </insert>
    
    
    
    
     <sql id="sqlPshCols">
                      CLIENT                    /*CLIENT        */
                    , CAMPAIGN_ID                    /*CAMPAIGN_ID        */
                    , MEMBER_SEQ                    /*MEMBER_SEQ        */
                    , SEND_GUBUN                    /*SEND_GUBUN        */
                    , SUBJECT                    /*SUBJECT        */
                    , PUSH_APP_ID                    /*PUSH_APP_ID        */
                    , PUSH_APP_OS                    /*PUSH_APP_OS        */
                    , PUSH_MSG                    /*PUSH_MSG        */
                    , PUSH_TKN_INFO                    /*PUSH_TKN_INFO        */
                    , PUSH_RESERVETIME                    /*PUSH_RESERVETIME        */
                    , PUSH_SEND_INTERVAL                    /*PUSH_SEND_INTERVAL        */
                    , DESTEL                    /*DESTEL        */
                    , SRCTEL                    /*SRCTEL        */
                    , SENDRESULT                    /*SENDRESULT        */
                    , PUSH_SENDTIME                    /*PUSH_SENDTIME        */
                    , PUSH_TRANSRESULT                    /*PUSH_TRANSRESULT        */
                    , PUSH_RESULTTIME                    /*PUSH_RESULTTIME        */
                    , SND_RETRY_CNT                    /*SND_RETRY_CNT        */
                    , PUSH_CP_ID                    /*PUSH_CP_ID        */
                    , SNDR_ID                    /*SNDR_ID        */
                    , SNDR_DEPT                    /*SNDR_DEPT        */
                    , MSG_JDT                    /*MSG_JDT        */
                    , MRKN_YN                    /*MRKN_YN        */
                    , REV_ID                    /*REV_ID        */
    </sql>
    
    
    
    <insert id="insertPush">
                INSERT /* com.ceragem.crm.camp.dao.CrmCampBasDao.insertPush */ INTO EON.PUSH_IF (
       		 <include refid="sqlPshCols"/>
                 ) 

					SELECT
				      'CRM'
				    , #{campBasNo}
				    , ROWNUM RNUM
				    , 'B' SEND_GUBUN
				    , C.Z023_TITLE SUBJECT
				    , 'AP_206220001'
				    , 1 APP_PUSH_OS_CD
				    , FN_GET_MSG(
			              #{itgCustNo}
			            , #{custNm}
			            , 'VIP'
			            , ( SELECT COUPN_BAS_NM FROM CRM_MSHIP_COUPN_BAS E WHERE A.APPLY_COUPN_BAS_NO = E.MSHIP_COUPN_BAS_NO )
			            , 

							(
	                        CASE WHEN ( SELECT NVL(USE_STD_DAY_COND_CD, 'N') FROM CRM_MSHIP_COUPN_BAS E WHERE A.APPLY_COUPN_BAS_NO = E.MSHIP_COUPN_BAS_NO ) = 'Y' THEN 
	                           
	                                TO_CHAR( SYSDATE + NVL( 
	                                ( SELECT COUPN_USE_POSS_DAY FROM CRM_MSHIP_COUPN_BAS E WHERE A.APPLY_COUPN_BAS_NO = E.MSHIP_COUPN_BAS_NO )
	                                , 730 ),'YYYY.MM.DD')
	                           
	                        ELSE
	                        
	                           ( SELECT TO_CHAR(  TO_DATE(TO_USE_STD_DAY , 'YYYYMMDD'), 'YYYY.MM.DD')  FROM CRM_MSHIP_COUPN_BAS E WHERE A.APPLY_COUPN_BAS_NO = E.MSHIP_COUPN_BAS_NO )
	                        
	                        END )
	                        
			            , A.APPLY_POINT
			            , '12345678'
			            , C.Z023_CONTENT
			        ) MSG			 
			   		, #{testSmsNo} APP_PUSH_TOKN
			        , TO_CHAR( SYSDATE , 'YYYYMMDDHH24MISS') PUSH_RESERVETIME
			        , 180 PUSH_SEND_INTERVAL
			        , #{testSmsNo} DESTEL
			        , '15775570' SRCTEL   
			        , 'P0' SENDRESULT
			        , NULL PUSH_SENDTIME			        
			        , NULL PUSH_TRANSRESULT
			        , NULL PUSH_RESULTTIME
			        , 0 SND_RETRY_CNT
			        , #{campBasNo} PUSH_CP_ID
			        , 'crm_1' SNDR_ID
			        , '141359' SNDR_DEPT
			        , SYSDATE MSG_JDT
			        , 'Y' MRKN_YN 
			        ,  #{itgCustNo}
			        FROM CRM_CAMP_BAS A
<!-- 			        LEFT JOIN EON.WSOMZ023 C ON 1=1   AND C.Z023_DUMMY1 = '07'  AND C.Z023_USRID IN ( 'crm_1', 'EONSMSEMTC' )  -->
			        
<!-- 			         <choose> -->
<!--                         <when test="z023Group != '' and z023Group != null ">AND C.Z023_GROUP = ${z023Group}</when> -->
<!--                         <otherwise>AND 1 = 2</otherwise> -->
<!--                      </choose> -->
                     
                    WHERE A.CAMP_BAS_NO=#{campBasNo}
			         
    </insert>
    
    
    
    <select id="selectCustGrp"  resultType="int">
    		
    					SELECT /* com.ceragem.crm.camp.dao.CrmCampBasDao.selectCustGrp */
							count( ITG_CUST_NO	) cnt
						FROM CRM_CUST_GRP_TGTR_REL
						WHERE CUST_GRP_NO = #{applyGrpNo}
						AND ITG_CUST_NO IS NOT NULL
						AND TGT_YN = 'Y'
    </select>
    
</mapper>
